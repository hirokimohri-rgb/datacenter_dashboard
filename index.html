<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Infrastructure Investment Dashboard (2021-2025)</title>
  <!-- React 18 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <!-- Prop-Types (Rechartsの依存) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.8.1/prop-types.min.js"></script>
  <!-- Recharts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.10.3/Recharts.min.js"></script>
  <!-- Babel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Noto Sans JP', 'Inter', system-ui, sans-serif;
      background: #ffffff;
      color: #1e293b;
    }
    .card {
      background: #ffffff;
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.04);
    }
    .metric-card {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 10px;
      padding: 16px;
      text-align: center;
    }
    .filter-btn {
      padding: 6px 14px;
      border-radius: 6px;
      border: 1px solid #e2e8f0;
      background: #fff;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.15s ease;
      color: #475569;
    }
    .filter-btn:hover { border-color: #3b82f6; color: #3b82f6; }
    .filter-btn.active { background: #3b82f6; color: white; border-color: #3b82f6; }
    .category-row {
      display: grid;
      grid-template-columns: 2fr repeat(5, 1fr) 70px 60px;
      padding: 8px 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.15s ease;
      align-items: center;
      border-bottom: 1px solid #f1f5f9;
      font-size: 11px;
    }
    .category-row:hover { background: #f8fafc; }
    .category-row.selected { background: #eff6ff; border-left: 3px solid #3b82f6; }
    .deal-row {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
      padding: 8px 12px;
      border-bottom: 1px solid #f1f5f9;
      font-size: 12px;
      align-items: center;
    }
    .deal-row:hover { background: #f8fafc; }
    .section-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #1e293b;
    }
    .badge {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 500;
    }
    select {
      padding: 6px 10px;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      font-size: 12px;
      color: #475569;
      background: #fff;
      cursor: pointer;
    }
    select:focus { outline: none; border-color: #3b82f6; }
    .year-cell { text-align: right; font-variant-numeric: tabular-nums; }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useMemo } = React;
    const { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, AreaChart, Area, LineChart, Line, Legend } = Recharts;

    // カテゴリマスタ
    const categoryMeta = {
      dc_general: { name: 'データセンター（汎用）', color: '#2563eb', group: 'DC/Computing' },
      dc_modular: { name: 'モジュラーDC', color: '#3b82f6', group: 'DC/Computing' },
      ee_computing: { name: '省エネコンピューティング', color: '#7c3aed', group: 'DC/Computing' },
      ee_chips: { name: '省エネチップ', color: '#6d28d9', group: 'DC/Computing' },
      cooling_immersion: { name: '液浸冷却', color: '#1d4ed8', group: 'DC/Computing' },
      cooling_d2c: { name: 'Direct-to-Chip冷却', color: '#1e40af', group: 'DC/Computing' },
      nuclear_fusion: { name: '核融合', color: '#059669', group: 'Generation' },
      nuclear_micro: { name: '原子力マイクロ炉', color: '#16a34a', group: 'Generation' },
      nuclear_smr: { name: '原子力SMR', color: '#22c55e', group: 'Generation' },
      nuclear_other: { name: '原子力（その他）', color: '#15803d', group: 'Generation' },
      geothermal: { name: '地熱', color: '#ea580c', group: 'Generation' },
      grid_analytics: { name: '送電網解析・制御', color: '#0891b2', group: 'Grid' },
      grid_der: { name: 'DER管理', color: '#0e7490', group: 'Grid' },
      grid_transformer: { name: '変圧器', color: '#06b6d4', group: 'Grid' },
      grid_cables: { name: 'ケーブル', color: '#0284c7', group: 'Grid' },
      grid_wildfire: { name: '災害管理', color: '#14b8a6', group: 'Grid' },
      storage_lithium: { name: '蓄電（リチウム）', color: '#be185d', group: 'Storage' },
      storage_flow: { name: '蓄電（フロー電池）', color: '#c026d3', group: 'Storage' },
      storage_thermal: { name: '蓄電（熱）', color: '#f59e0b', group: 'Storage' },
      storage_mech: { name: '蓄電（機械式）', color: '#a21caf', group: 'Storage' },
      storage_sodium: { name: '蓄電（ナトリウム）', color: '#e11d48', group: 'Storage' },
      storage_other: { name: '蓄電（その他）', color: '#db2777', group: 'Storage' },
      solar: { name: '太陽光', color: '#fbbf24', group: 'Other' },
      wind: { name: '風力', color: '#34d399', group: 'Other' },
      hydrogen: { name: '水素', color: '#60a5fa', group: 'Other' },
      buildings: { name: 'ビル/空調', color: '#f472b6', group: 'Other' },
      other: { name: 'その他', color: '#94a3b8', group: 'Other' }
    };

    // カテゴリ-年-ステージ別データ
    const categoryYearStageData = {"ee_computing":{"2021":{"Seed":{"count":1,"amount":1.1},"Series A":{"count":1,"amount":8.0},"Series B":{"count":2,"amount":29.5},"Growth Equity":{"count":3,"amount":150.0}},"2022":{"Seed":{"count":1,"amount":0.2},"Series A":{"count":1,"amount":8.0},"Series B":{"count":1,"amount":100.0},"Growth Equity":{"count":5,"amount":350.0}},"2023":{"Seed":{"count":2,"amount":4.5},"Series A":{"count":3,"amount":60.0},"Series B":{"count":1,"amount":25.0},"Growth Equity":{"count":2,"amount":75.0}},"2024":{"Seed":{"count":2,"amount":6.0},"Series A":{"count":4,"amount":55.0},"Series B":{"count":3,"amount":145.0},"Growth Equity":{"count":7,"amount":700.0}},"2025":{"Seed":{"count":1,"amount":5.0},"Series A":{"count":3,"amount":44.4},"Series B":{"count":3,"amount":130.0},"Growth Equity":{"count":9,"amount":1775.0}}},"storage_other":{"2021":{"Seed":{"count":13,"amount":30.2},"Series A":{"count":11,"amount":100.0},"Series B":{"count":9,"amount":132.0},"Growth Equity":{"count":11,"amount":235.0}},"2022":{"Seed":{"count":15,"amount":35.9},"Series A":{"count":17,"amount":195.0},"Series B":{"count":11,"amount":234.0},"Growth Equity":{"count":13,"amount":315.0}},"2023":{"Seed":{"count":17,"amount":42.0},"Series A":{"count":14,"amount":169.0},"Series B":{"count":9,"amount":195.0},"Growth Equity":{"count":10,"amount":335.0}},"2024":{"Seed":{"count":8,"amount":23.4},"Series A":{"count":10,"amount":155.0},"Series B":{"count":9,"amount":433.0},"Growth Equity":{"count":11,"amount":510.0}},"2025":{"Seed":{"count":5,"amount":15.5},"Series A":{"count":5,"amount":56.0},"Series B":{"count":8,"amount":275.0},"Growth Equity":{"count":15,"amount":1300.0}}},"nuclear_micro":{"2021":{"Seed":{"count":1,"amount":0.9},"Series A":{"count":1,"amount":1.0}},"2022":{"Series A":{"count":1,"amount":0.3}},"2023":{"Series A":{"count":1,"amount":11.9},"Growth Equity":{"count":3,"amount":235.0}},"2024":{"Series A":{"count":1,"amount":59.2},"Growth Equity":{"count":3,"amount":500.0}},"2025":{"Series B":{"count":1,"amount":71.0},"Growth Equity":{"count":3,"amount":1000.0}}},"geothermal":{"2021":{"Seed":{"count":5,"amount":12.0},"Series A":{"count":3,"amount":43.0},"Series B":{"count":2,"amount":55.0},"Growth Equity":{"count":1,"amount":25.0}},"2022":{"Seed":{"count":3,"amount":9.6},"Series A":{"count":3,"amount":65.0},"Series B":{"count":2,"amount":110.0},"Growth Equity":{"count":2,"amount":100.0}},"2023":{"Seed":{"count":2,"amount":6.1},"Series A":{"count":3,"amount":77.0},"Series B":{"count":2,"amount":60.0},"Growth Equity":{"count":3,"amount":232.0}},"2024":{"Seed":{"count":2,"amount":7.6},"Series A":{"count":5,"amount":102.0},"Series B":{"count":3,"amount":153.0},"Growth Equity":{"count":5,"amount":379.0}},"2025":{"Seed":{"count":1,"amount":0.7},"Series A":{"count":3,"amount":85.0},"Series B":{"count":1,"amount":0.0},"Growth Equity":{"count":5,"amount":662.0}}},"nuclear_other":{"2021":{"Seed":{"count":3,"amount":5.8},"Series A":{"count":2,"amount":120.0},"Series B":{"count":1,"amount":20.0}},"2022":{"Seed":{"count":1,"amount":2.0},"Series A":{"count":2,"amount":347.7},"Growth Equity":{"count":2,"amount":750.0}},"2023":{"Seed":{"count":2,"amount":4.8},"Series A":{"count":2,"amount":50.0},"Series B":{"count":1,"amount":35.0},"Growth Equity":{"count":1,"amount":15.0}},"2024":{"Seed":{"count":2,"amount":6.2},"Series A":{"count":5,"amount":155.0},"Series B":{"count":2,"amount":70.0},"Growth Equity":{"count":2,"amount":100.0}},"2025":{"Seed":{"count":3,"amount":14.4},"Series A":{"count":7,"amount":200.0},"Series B":{"count":2,"amount":100.0},"Growth Equity":{"count":6,"amount":1150.0}}},"solar":{"2021":{"Seed":{"count":28,"amount":52.7},"Series A":{"count":29,"amount":295.0},"Series B":{"count":21,"amount":519.0},"Growth Equity":{"count":26,"amount":900.0}},"2022":{"Seed":{"count":22,"amount":48.8},"Series A":{"count":29,"amount":406.0},"Series B":{"count":23,"amount":714.0},"Growth Equity":{"count":24,"amount":1700.0}},"2023":{"Seed":{"count":17,"amount":35.7},"Series A":{"count":30,"amount":592.0},"Series B":{"count":30,"amount":1800.0},"Growth Equity":{"count":31,"amount":3400.0}},"2024":{"Seed":{"count":13,"amount":28.1},"Series A":{"count":24,"amount":269.0},"Series B":{"count":19,"amount":300.0},"Growth Equity":{"count":17,"amount":300.0}},"2025":{"Seed":{"count":6,"amount":13.9},"Series A":{"count":17,"amount":215.0},"Series B":{"count":19,"amount":570.0},"Growth Equity":{"count":15,"amount":500.0}}},"storage_mech":{"2021":{"Seed":{"count":2,"amount":4.8},"Series A":{"count":2,"amount":50.0},"Series B":{"count":1,"amount":0.0},"Growth Equity":{"count":1,"amount":100.0}},"2022":{"Series A":{"count":1,"amount":0.0},"Series B":{"count":1,"amount":0.0}},"2023":{"Seed":{"count":1,"amount":0.7},"Series A":{"count":1,"amount":50.0},"Series B":{"count":1,"amount":0.0},"Growth Equity":{"count":1,"amount":100.0}},"2024":{"Series A":{"count":2,"amount":53.3},"Series B":{"count":1,"amount":50.0},"Growth Equity":{"count":3,"amount":323.2}},"2025":{"Series A":{"count":1,"amount":23.4},"Growth Equity":{"count":3,"amount":371.0}}},"other":{"2021":{"Seed":{"count":26,"amount":45.8},"Series A":{"count":31,"amount":280.0},"Series B":{"count":28,"amount":420.0},"Growth Equity":{"count":34,"amount":1150.0}},"2022":{"Seed":{"count":21,"amount":38.1},"Series A":{"count":26,"amount":335.0},"Series B":{"count":26,"amount":697.0},"Growth Equity":{"count":38,"amount":2850.0}},"2023":{"Seed":{"count":22,"amount":42.2},"Series A":{"count":32,"amount":370.0},"Series B":{"count":28,"amount":505.0},"Growth Equity":{"count":41,"amount":1375.0}},"2024":{"Seed":{"count":18,"amount":32.9},"Series A":{"count":30,"amount":296.0},"Series B":{"count":25,"amount":400.0},"Growth Equity":{"count":35,"amount":700.0}},"2025":{"Seed":{"count":8,"amount":18.2},"Series A":{"count":18,"amount":172.0},"Series B":{"count":17,"amount":300.0},"Growth Equity":{"count":23,"amount":703.0}}},"storage_lithium":{"2021":{"Seed":{"count":6,"amount":12.8},"Series A":{"count":11,"amount":234.0},"Series B":{"count":13,"amount":2843.0},"Growth Equity":{"count":14,"amount":3988.0}},"2022":{"Seed":{"count":9,"amount":19.9},"Series A":{"count":13,"amount":209.0},"Series B":{"count":14,"amount":633.0},"Growth Equity":{"count":13,"amount":1077.0}},"2023":{"Seed":{"count":5,"amount":13.5},"Series A":{"count":9,"amount":130.0},"Series B":{"count":8,"amount":490.0},"Growth Equity":{"count":13,"amount":2000.0}},"2024":{"Seed":{"count":5,"amount":9.6},"Series A":{"count":9,"amount":95.0},"Series B":{"count":9,"amount":250.0},"Growth Equity":{"count":11,"amount":400.0}},"2025":{"Seed":{"count":2,"amount":7.4},"Series A":{"count":5,"amount":50.0},"Series B":{"count":4,"amount":60.0},"Growth Equity":{"count":7,"amount":280.0}}},"grid_transformer":{"2022":{"Series A":{"count":1,"amount":3.9}},"2023":{"Seed":{"count":1,"amount":2.8},"Series A":{"count":1,"amount":15.0}},"2024":{"Series A":{"count":1,"amount":12.4}},"2025":{"Series A":{"count":2,"amount":58.0},"Series B":{"count":1,"amount":17.0},"Growth Equity":{"count":1,"amount":80.0}}},"grid_der":{"2021":{"Seed":{"count":8,"amount":13.5},"Series A":{"count":5,"amount":50.0},"Series B":{"count":4,"amount":90.0},"Growth Equity":{"count":4,"amount":85.0}},"2022":{"Seed":{"count":4,"amount":10.0},"Series A":{"count":4,"amount":55.0},"Series B":{"count":5,"amount":120.0},"Growth Equity":{"count":6,"amount":300.0}},"2023":{"Seed":{"count":3,"amount":7.7},"Series A":{"count":4,"amount":52.0},"Series B":{"count":3,"amount":70.0},"Growth Equity":{"count":3,"amount":100.0}},"2024":{"Seed":{"count":2,"amount":5.6},"Series A":{"count":4,"amount":47.0},"Series B":{"count":5,"amount":120.0},"Growth Equity":{"count":3,"amount":99.0}},"2025":{"Seed":{"count":1,"amount":3.3},"Series A":{"count":3,"amount":33.0},"Series B":{"count":5,"amount":100.0},"Growth Equity":{"count":3,"amount":50.0}}},"grid_wildfire":{"2021":{"Seed":{"count":2,"amount":4.3},"Series A":{"count":1,"amount":5.0}},"2022":{"Series A":{"count":1,"amount":5.2}},"2023":{"Seed":{"count":1,"amount":4.5},"Series A":{"count":1,"amount":20.0}},"2025":{"Series B":{"count":2,"amount":81.4},"Growth Equity":{"count":1,"amount":43.0}}},"nuclear_smr":{"2021":{"Seed":{"count":1,"amount":3.0},"Series A":{"count":1,"amount":40.0},"Growth Equity":{"count":2,"amount":152.0}},"2022":{"Series A":{"count":1,"amount":30.0}},"2023":{"Seed":{"count":2,"amount":2.0},"Series A":{"count":1,"amount":2.0}},"2024":{"Series A":{"count":2,"amount":11.3},"Growth Equity":{"count":1,"amount":45.0}},"2025":{"Seed":{"count":1,"amount":22.0},"Series A":{"count":1,"amount":50.0},"Growth Equity":{"count":1,"amount":50.0}}},"dc_modular":{"2021":{"Series A":{"count":1,"amount":6.4}},"2023":{"Series A":{"count":1,"amount":7.0},"Growth Equity":{"count":1,"amount":55.0}},"2024":{"Series A":{"count":1,"amount":20.0},"Series B":{"count":1,"amount":40.0}},"2025":{"Seed":{"count":1,"amount":3.5},"Series A":{"count":1,"amount":50.0},"Series B":{"count":1,"amount":35.0}}},"dc_general":{"2021":{"Series A":{"count":1,"amount":12.0},"Series B":{"count":1,"amount":50.0},"Growth Equity":{"count":3,"amount":317.0}},"2022":{"Seed":{"count":1,"amount":3.8},"Series A":{"count":2,"amount":40.0},"Growth Equity":{"count":3,"amount":50.0}},"2023":{"Seed":{"count":1,"amount":1.7},"Series A":{"count":1,"amount":15.0},"Series B":{"count":1,"amount":20.0}},"2024":{"Series A":{"count":4,"amount":312.0},"Series B":{"count":1,"amount":50.0},"Growth Equity":{"count":5,"amount":7000.0}},"2025":{"Seed":{"count":2,"amount":5.5},"Series A":{"count":3,"amount":75.0},"Series B":{"count":3,"amount":100.0},"Growth Equity":{"count":13,"amount":6300.0}}},"nuclear_fusion":{"2021":{"Seed":{"count":3,"amount":8.4},"Series A":{"count":2,"amount":75.0},"Series B":{"count":2,"amount":1880.0},"Growth Equity":{"count":3,"amount":800.0}},"2022":{"Seed":{"count":2,"amount":7.1},"Series A":{"count":2,"amount":70.0},"Series B":{"count":2,"amount":0.0},"Growth Equity":{"count":4,"amount":500.0}},"2023":{"Seed":{"count":6,"amount":22.7},"Series A":{"count":7,"amount":150.0},"Series B":{"count":5,"amount":200.0},"Growth Equity":{"count":4,"amount":200.0}},"2024":{"Seed":{"count":3,"amount":16.3},"Series A":{"count":9,"amount":1015.0},"Series B":{"count":4,"amount":200.0},"Growth Equity":{"count":7,"amount":400.0}},"2025":{"Seed":{"count":3,"amount":13.0},"Series A":{"count":8,"amount":363.0},"Series B":{"count":4,"amount":990.0},"Growth Equity":{"count":7,"amount":600.0}}},"hydrogen":{"2021":{"Seed":{"count":15,"amount":28.4},"Series A":{"count":17,"amount":175.0},"Series B":{"count":12,"amount":270.0},"Growth Equity":{"count":15,"amount":550.0}},"2022":{"Seed":{"count":16,"amount":33.6},"Series A":{"count":22,"amount":335.0},"Series B":{"count":18,"amount":480.0},"Growth Equity":{"count":23,"amount":1000.0}},"2023":{"Seed":{"count":10,"amount":25.1},"Series A":{"count":18,"amount":294.0},"Series B":{"count":14,"amount":430.0},"Growth Equity":{"count":20,"amount":1100.0}},"2024":{"Seed":{"count":7,"amount":17.4},"Series A":{"count":15,"amount":221.0},"Series B":{"count":14,"amount":420.0},"Growth Equity":{"count":18,"amount":750.0}},"2025":{"Seed":{"count":4,"amount":8.9},"Series A":{"count":11,"amount":115.0},"Series B":{"count":11,"amount":200.0},"Growth Equity":{"count":14,"amount":250.0}}},"grid_analytics":{"2021":{"Seed":{"count":5,"amount":9.5},"Series A":{"count":4,"amount":56.0},"Series B":{"count":4,"amount":80.0},"Growth Equity":{"count":6,"amount":600.0}},"2022":{"Seed":{"count":2,"amount":6.4},"Series A":{"count":3,"amount":30.0},"Series B":{"count":4,"amount":130.0},"Growth Equity":{"count":4,"amount":200.0}},"2023":{"Seed":{"count":4,"amount":9.3},"Series A":{"count":5,"amount":48.0},"Series B":{"count":3,"amount":30.0},"Growth Equity":{"count":4,"amount":30.0}},"2024":{"Seed":{"count":4,"amount":13.6},"Series A":{"count":7,"amount":85.0},"Series B":{"count":5,"amount":70.0},"Growth Equity":{"count":6,"amount":100.0}},"2025":{"Seed":{"count":2,"amount":6.5},"Series A":{"count":3,"amount":45.0},"Series B":{"count":5,"amount":170.0},"Growth Equity":{"count":3,"amount":65.0}}},"buildings":{"2021":{"Seed":{"count":28,"amount":52.5},"Series A":{"count":29,"amount":278.0},"Series B":{"count":22,"amount":425.0},"Growth Equity":{"count":25,"amount":750.0}},"2022":{"Seed":{"count":18,"amount":37.1},"Series A":{"count":24,"amount":350.0},"Series B":{"count":22,"amount":675.0},"Growth Equity":{"count":28,"amount":1300.0}},"2023":{"Seed":{"count":24,"amount":49.6},"Series A":{"count":35,"amount":463.0},"Series B":{"count":31,"amount":1051.0},"Growth Equity":{"count":37,"amount":1000.0}},"2024":{"Seed":{"count":16,"amount":33.8},"Series A":{"count":28,"amount":265.0},"Series B":{"count":22,"amount":360.0},"Growth Equity":{"count":23,"amount":300.0}},"2025":{"Seed":{"count":10,"amount":23.7},"Series A":{"count":18,"amount":192.0},"Series B":{"count":18,"amount":358.0},"Growth Equity":{"count":20,"amount":1000.0}}},"storage_flow":{"2021":{"Seed":{"count":1,"amount":3.9},"Series A":{"count":2,"amount":40.0},"Series B":{"count":1,"amount":10.0},"Growth Equity":{"count":3,"amount":240.0}},"2022":{"Seed":{"count":1,"amount":4.1},"Series A":{"count":2,"amount":30.0},"Series B":{"count":2,"amount":80.0},"Growth Equity":{"count":4,"amount":450.0}},"2023":{"Seed":{"count":2,"amount":6.1},"Series A":{"count":3,"amount":55.0},"Series B":{"count":2,"amount":100.0},"Growth Equity":{"count":3,"amount":300.0}},"2024":{"Seed":{"count":1,"amount":1.7},"Series A":{"count":1,"amount":30.0},"Series B":{"count":1,"amount":50.0},"Growth Equity":{"count":4,"amount":405.0}},"2025":{"Series A":{"count":3,"amount":32.8},"Series B":{"count":3,"amount":50.0},"Growth Equity":{"count":3,"amount":0.0}}},"wind":{"2021":{"Seed":{"count":6,"amount":12.2},"Series A":{"count":7,"amount":70.0},"Series B":{"count":5,"amount":110.0},"Growth Equity":{"count":5,"amount":100.0}},"2022":{"Seed":{"count":4,"amount":8.7},"Series A":{"count":7,"amount":65.0},"Series B":{"count":6,"amount":90.0},"Growth Equity":{"count":6,"amount":50.0}},"2023":{"Seed":{"count":4,"amount":7.6},"Series A":{"count":6,"amount":55.0},"Series B":{"count":6,"amount":50.0},"Growth Equity":{"count":6,"amount":30.0}},"2024":{"Seed":{"count":4,"amount":7.5},"Series A":{"count":9,"amount":80.0},"Series B":{"count":7,"amount":70.0},"Growth Equity":{"count":6,"amount":50.0}},"2025":{"Seed":{"count":1,"amount":3.8},"Series A":{"count":3,"amount":25.0},"Series B":{"count":3,"amount":30.0},"Growth Equity":{"count":2,"amount":30.0}}},"cooling_d2c":{"2021":{"Seed":{"count":1,"amount":0.7},"Series A":{"count":1,"amount":2.0}},"2022":{"Series A":{"count":1,"amount":7.3},"Series B":{"count":1,"amount":36.0}},"2023":{"Seed":{"count":1,"amount":4.0},"Series A":{"count":1,"amount":8.0},"Series B":{"count":1,"amount":9.0}},"2024":{"Series B":{"count":2,"amount":24.0}},"2025":{"Seed":{"count":2,"amount":0.0}}},"ee_chips":{"2022":{"Series A":{"count":1,"amount":14.7},"Series B":{"count":1,"amount":25.0}},"2023":{"Seed":{"count":1,"amount":1.7},"Series A":{"count":1,"amount":25.0},"Series B":{"count":2,"amount":154.0}},"2024":{"Series A":{"count":4,"amount":301.9},"Growth Equity":{"count":5,"amount":400.0}},"2025":{"Seed":{"count":1,"amount":7.8},"Series A":{"count":2,"amount":50.0},"Series B":{"count":1,"amount":50.0}}},"storage_thermal":{"2021":{"Seed":{"count":4,"amount":9.8},"Series A":{"count":3,"amount":36.0},"Series B":{"count":2,"amount":40.0},"Growth Equity":{"count":2,"amount":60.0}},"2022":{"Seed":{"count":2,"amount":4.9},"Series A":{"count":3,"amount":43.0},"Series B":{"count":1,"amount":20.0},"Growth Equity":{"count":2,"amount":30.0}},"2023":{"Seed":{"count":4,"amount":9.8},"Series A":{"count":4,"amount":51.0},"Series B":{"count":4,"amount":80.0},"Growth Equity":{"count":3,"amount":60.0}},"2024":{"Seed":{"count":3,"amount":8.9},"Series A":{"count":5,"amount":70.0},"Series B":{"count":5,"amount":0.0},"Growth Equity":{"count":5,"amount":150.0}},"2025":{"Seed":{"count":2,"amount":3.7},"Series A":{"count":4,"amount":50.0},"Series B":{"count":2,"amount":30.0},"Growth Equity":{"count":2,"amount":0.0}}},"cooling_immersion":{"2021":{"Seed":{"count":2,"amount":1.2},"Series A":{"count":1,"amount":1.0}},"2022":{"Series A":{"count":1,"amount":12.0},"Series B":{"count":1,"amount":50.0}},"2023":{"Series B":{"count":1,"amount":81.0}},"2024":{"Seed":{"count":1,"amount":0.5},"Series A":{"count":1,"amount":20.0},"Series B":{"count":2,"amount":160.0}},"2025":{"Growth Equity":{"count":2,"amount":153.0}}},"storage_sodium":{"2021":{"Seed":{"count":1,"amount":1.2},"Series A":{"count":1,"amount":20.0},"Series B":{"count":1,"amount":20.0}},"2022":{"Seed":{"count":1,"amount":2.0},"Series A":{"count":1,"amount":4.7},"Series B":{"count":2,"amount":58.0}},"2023":{"Series A":{"count":2,"amount":5.0},"Series B":{"count":1,"amount":5.0}},"2024":{"Seed":{"count":1,"amount":0.4},"Series A":{"count":2,"amount":35.0},"Series B":{"count":2,"amount":75.0},"Growth Equity":{"count":1,"amount":0.0}},"2025":{"Series A":{"count":1,"amount":1.0},"Series B":{"count":2,"amount":55.6},"Growth Equity":{"count":1,"amount":55.4}}},"grid_cables":{"2021":{"Series A":{"count":1,"amount":8.0},"Series B":{"count":1,"amount":25.0}},"2022":{"Growth Equity":{"count":1,"amount":154.0}},"2023":{"Series B":{"count":1,"amount":24.9}},"2024":{"Seed":{"count":1,"amount":0.1},"Series A":{"count":2,"amount":25.0},"Series B":{"count":1,"amount":25.0}},"2025":{"Series B":{"count":1,"amount":75.0}}}};

    // トップディール
    const allDeals = [{"company":"Vantage Data Centers","amount":6400.0,"quarter":"2024/Q1","year":"2024","stage":"Growth Equity","country":"United States","category":"dc_general"},{"company":"Vantage Data Centers","amount":3000.0,"quarter":"2025/Q3","year":"2025","stage":"Growth Equity","country":"United States","category":"dc_general"},{"company":"Northvolt","amount":2750.0,"quarter":"2021/Q2","year":"2021","stage":"Growth Equity","country":"Sweden","category":"storage_lithium"},{"company":"Commonwealth Fusion Systems","amount":1800.0,"quarter":"2021/Q4","year":"2021","stage":"Series B","country":"United States","category":"nuclear_fusion"},{"company":"Lineage Logistics","amount":1700.0,"quarter":"2022/Q1","year":"2022","stage":"Growth Equity","country":"United States","category":"other"},{"company":"Vantage Data Centers","amount":1600.0,"quarter":"2025/Q3","year":"2025","stage":"Growth Equity","country":"United States","category":"dc_general"},{"company":"Svolt","amount":1600.0,"quarter":"2021/Q3","year":"2021","stage":"Series B","country":"China","category":"storage_lithium"},{"company":"Yingfa Group","amount":1450.0,"quarter":"2023/Q1","year":"2023","stage":"Growth Equity","country":"China","category":"solar"},{"company":"Crusoe","amount":1375.0,"quarter":"2025/Q4","year":"2025","stage":"Growth Equity","country":"United States","category":"ee_computing"},{"company":"Base Power Company","amount":1000.0,"quarter":"2025/Q4","year":"2025","stage":"Growth Equity","country":"United States","category":"storage_other"},{"company":"Svolt","amount":942.0,"quarter":"2021/Q4","year":"2021","stage":"Series B","country":"China","category":"storage_lithium"},{"company":"Verkor","amount":907.0,"quarter":"2023/Q3","year":"2023","stage":"Growth Equity","country":"France","category":"storage_lithium"},{"company":"Pacific Fusion","amount":900.0,"quarter":"2024/Q4","year":"2024","stage":"Series A","country":"United States","category":"nuclear_fusion"},{"company":"Octopus Energy","amount":874.7,"quarter":"2023/Q4","year":"2023","stage":"Growth Equity","country":"United Kingdom","category":"other"},{"company":"Commonwealth Fusion Systems","amount":863.0,"quarter":"2025/Q3","year":"2025","stage":"Series B","country":"United States","category":"nuclear_fusion"},{"company":"TerraPower","amount":750.0,"quarter":"2022/Q3","year":"2022","stage":"Growth Equity","country":"United States","category":"nuclear_other"},{"company":"X-Energy","amount":700.0,"quarter":"2025/Q4","year":"2025","stage":"Growth Equity","country":"United States","category":"nuclear_micro"},{"company":"Serentica Renewables","amount":672.9,"quarter":"2023/Q3","year":"2023","stage":"Growth Equity","country":"India","category":"solar"},{"company":"TerraPower","amount":650.0,"quarter":"2025/Q2","year":"2025","stage":"Growth Equity","country":"United States","category":"nuclear_other"},{"company":"Digital Edge DC","amount":640.0,"quarter":"2025/Q1","year":"2025","stage":"Growth Equity","country":"Singapore","category":"dc_general"},{"company":"Hithium","amount":622.0,"quarter":"2023/Q3","year":"2023","stage":"Growth Equity","country":"China","category":"storage_lithium"},{"company":"Crusoe","amount":600.0,"quarter":"2024/Q4","year":"2024","stage":"Growth Equity","country":"United States","category":"ee_computing"},{"company":"Octopus Energy","amount":600.0,"quarter":"2021/Q3","year":"2021","stage":"Growth Equity","country":"United Kingdom","category":"other"},{"company":"Scala Data Centers","amount":550.0,"quarter":"2024/Q4","year":"2024","stage":"Growth Equity","country":"Brazil","category":"dc_general"},{"company":"Svolt","amount":533.7,"quarter":"2021/Q1","year":"2021","stage":"Series A","country":"China","category":"storage_lithium"},{"company":"Takanock","amount":500.0,"quarter":"2025/Q2","year":"2025","stage":"Growth Equity","country":"United States","category":"dc_general"},{"company":"X-Energy","amount":500.0,"quarter":"2024/Q4","year":"2024","stage":"Growth Equity","country":"United States","category":"nuclear_micro"},{"company":"Helion Energy","amount":500.0,"quarter":"2021/Q4","year":"2021","stage":"Growth Equity","country":"United States","category":"nuclear_fusion"},{"company":"EcoDataCenter","amount":485.7,"quarter":"2025/Q1","year":"2025","stage":"Growth Equity","country":"Sweden","category":"dc_general"},{"company":"1Komma5","amount":467.9,"quarter":"2023/Q2","year":"2023","stage":"Series B","country":"Germany","category":"buildings"},{"company":"Fervo Energy","amount":462.0,"quarter":"2025/Q4","year":"2025","stage":"Growth Equity","country":"United States","category":"geothermal"},{"company":"Form Energy","amount":450.0,"quarter":"2022/Q4","year":"2022","stage":"Growth Equity","country":"United States","category":"storage_flow"},{"company":"Helion Energy","amount":425.0,"quarter":"2025/Q1","year":"2025","stage":"Growth Equity","country":"United States","category":"nuclear_fusion"},{"company":"Form Energy","amount":405.0,"quarter":"2024/Q4","year":"2024","stage":"Growth Equity","country":"United States","category":"storage_flow"},{"company":"Lightmatter","amount":400.0,"quarter":"2024/Q4","year":"2024","stage":"Growth Equity","country":"United States","category":"ee_chips"},{"company":"Northvolt","amount":400.0,"quarter":"2023/Q2","year":"2023","stage":"Growth Equity","country":"Sweden","category":"storage_lithium"},{"company":"Claroty","amount":400.0,"quarter":"2021/Q4","year":"2021","stage":"Growth Equity","country":"United States","category":"grid_analytics"},{"company":"Electric Hydrogen","amount":380.0,"quarter":"2023/Q4","year":"2023","stage":"Growth Equity","country":"United States","category":"hydrogen"},{"company":"Palmetto","amount":375.0,"quarter":"2022/Q1","year":"2022","stage":"Growth Equity","country":"United States","category":"solar"},{"company":"Gaojing Solar","amount":360.0,"quarter":"2022/Q3","year":"2022","stage":"Series B","country":"China","category":"solar"},{"company":"Kaer","amount":350.0,"quarter":"2025/Q2","year":"2025","stage":"Growth Equity","country":"Singapore","category":"buildings"},{"company":"Crusoe","amount":350.0,"quarter":"2022/Q2","year":"2022","stage":"Growth Equity","country":"United States","category":"ee_computing"},{"company":"Highview Power","amount":323.2,"quarter":"2024/Q2","year":"2024","stage":"Growth Equity","country":"United Kingdom","category":"storage_mech"},{"company":"EnerVenue","amount":308.1,"quarter":"2024/Q2","year":"2024","stage":"Series B","country":"United States","category":"storage_other"},{"company":"newcleo","amount":307.7,"quarter":"2022/Q2","year":"2022","stage":"Series A","country":"France","category":"nuclear_other"},{"company":"Radiant","amount":300.0,"quarter":"2025/Q4","year":"2025","stage":"Growth Equity","country":"United States","category":"nuclear_other"},{"company":"Our Next Energy","amount":300.0,"quarter":"2023/Q1","year":"2023","stage":"Series B","country":"United States","category":"storage_lithium"},{"company":"Lunar Energy","amount":300.0,"quarter":"2022/Q3","year":"2022","stage":"Seed","country":"United States","category":"grid_der"},{"company":"Monolith","amount":300.0,"quarter":"2022/Q3","year":"2022","stage":"Growth Equity","country":"United States","category":"hydrogen"},{"company":"TAE Technologies","amount":280.0,"quarter":"2021/Q2","year":"2021","stage":"Growth Equity","country":"United States","category":"nuclear_fusion"},{"company":"Mainspring Energy","amount":258.0,"quarter":"2025/Q2","year":"2025","stage":"Growth Equity","country":"United States","category":"buildings"},{"company":"Deep Green","amount":252.6,"quarter":"2024/Q1","year":"2024","stage":"Series A","country":"United Kingdom","category":"dc_general"},{"company":"TAE Technologies","amount":250.0,"quarter":"2022/Q3","year":"2022","stage":"Growth Equity","country":"United States","category":"nuclear_fusion"},{"company":"Fervo Energy","amount":244.0,"quarter":"2024/Q1","year":"2024","stage":"Growth Equity","country":"United States","category":"geothermal"},{"company":"X-Energy","amount":235.0,"quarter":"2023/Q4","year":"2023","stage":"Growth Equity","country":"United States","category":"nuclear_micro"},{"company":"Sunfire","amount":233.0,"quarter":"2024/Q1","year":"2024","stage":"Growth Equity","country":"Germany","category":"hydrogen"},{"company":"Firmus Technologies","amount":220.0,"quarter":"2025/Q3","year":"2025","stage":"Growth Equity","country":"Singapore","category":"ee_computing"},{"company":"Torus","amount":200.0,"quarter":"2025/Q3","year":"2025","stage":"Growth Equity","country":"United States","category":"storage_mech"},{"company":"Base Power Company","amount":200.0,"quarter":"2025/Q2","year":"2025","stage":"Series B","country":"United States","category":"storage_other"},{"company":"X-Energy","amount":200.0,"quarter":"2025/Q1","year":"2025","stage":"Growth Equity","country":"United States","category":"nuclear_micro"},{"company":"Eavor Technologies","amount":182.0,"quarter":"2023/Q4","year":"2023","stage":"Growth Equity","country":"Canada","category":"geothermal"},{"company":"Highview Power","amount":171.0,"quarter":"2025/Q4","year":"2025","stage":"Growth Equity","country":"United Kingdom","category":"storage_mech"},{"company":"Auradine","amount":153.0,"quarter":"2025/Q2","year":"2025","stage":"Growth Equity","country":"United States","category":"cooling_immersion"},{"company":"Antora Energy","amount":150.0,"quarter":"2024/Q1","year":"2024","stage":"Growth Equity","country":"United States","category":"storage_thermal"},{"company":"Type One Energy","amount":135.0,"quarter":"2025/Q3","year":"2025","stage":"Series A","country":"United States","category":"nuclear_fusion"},{"company":"Fervo Energy","amount":135.0,"quarter":"2024/Q4","year":"2024","stage":"Growth Equity","country":"United States","category":"geothermal"},{"company":"Zap Energy","amount":115.0,"quarter":"2025/Q1","year":"2025","stage":"Growth Equity","country":"United States","category":"nuclear_fusion"},{"company":"Last Energy","amount":100.0,"quarter":"2025/Q4","year":"2025","stage":"Growth Equity","country":"United States","category":"nuclear_other"},{"company":"Fervo Energy","amount":100.0,"quarter":"2025/Q2","year":"2025","stage":"Growth Equity","country":"United States","category":"geothermal"},{"company":"Kaluza","amount":99.0,"quarter":"2024/Q2","year":"2024","stage":"Series B","country":"United Kingdom","category":"grid_der"},{"company":"Exodigo","amount":96.0,"quarter":"2025/Q3","year":"2025","stage":"Series B","country":"Israel","category":"grid_analytics"},{"company":"Amperesand","amount":80.0,"quarter":"2025/Q4","year":"2025","stage":"Series A","country":"Singapore","category":"grid_transformer"},{"company":"Blue Current","amount":80.0,"quarter":"2025/Q4","year":"2025","stage":"Growth Equity","country":"United States","category":"storage_lithium"},{"company":"VEIR","amount":75.0,"quarter":"2025/Q1","year":"2025","stage":"Series B","country":"United States","category":"grid_cables"},{"company":"Daylight","amount":75.0,"quarter":"2025/Q4","year":"2025","stage":"Series B","country":"United States","category":"grid_der"},{"company":"Antares","amount":71.0,"quarter":"2025/Q4","year":"2025","stage":"Series B","country":"United States","category":"nuclear_micro"},{"company":"Smart Wires","amount":65.0,"quarter":"2025/Q1","year":"2025","stage":"Growth Equity","country":"United States","category":"grid_analytics"},{"company":"Radiant","amount":65.0,"quarter":"2025/Q2","year":"2025","stage":"Series A","country":"United States","category":"nuclear_other"},{"company":"Corvus Energy","amount":60.0,"quarter":"2025/Q4","year":"2025","stage":"Growth Equity","country":"Canada","category":"storage_lithium"},{"company":"Gridware","amount":55.0,"quarter":"2025/Q4","year":"2025","stage":"Series B","country":"United States","category":"grid_wildfire"},{"company":"Natron Energy","amount":55.4,"quarter":"2025/Q2","year":"2025","stage":"Growth Equity","country":"United States","category":"storage_sodium"},{"company":"Exowatt","amount":50.0,"quarter":"2025/Q4","year":"2025","stage":"Series A","country":"United States","category":"dc_modular"},{"company":"Blykalla","amount":50.0,"quarter":"2025/Q4","year":"2025","stage":"Series A","country":"Sweden","category":"nuclear_smr"},{"company":"Eavor","amount":50.0,"quarter":"2025/Q1","year":"2025","stage":"Series A","country":"Canada","category":"geothermal"}];

    const years = ['2021', '2022', '2023', '2024', '2025'];
    const stages = ['Seed', 'Series A', 'Series B', 'Growth Equity'];
    const groups = ['DC/Computing', 'Generation', 'Grid', 'Storage', 'Other'];

    function Dashboard() {
      const [selectedCategory, setSelectedCategory] = useState(null);
      const [selectedYear, setSelectedYear] = useState('all');
      const [selectedStage, setSelectedStage] = useState('all');
      const [selectedGroup, setSelectedGroup] = useState('all');
      const [sortBy, setSortBy] = useState('total');

      // カテゴリ集計（ステージフィルタ対応）
      const categoryStats = useMemo(() => {
        return Object.entries(categoryYearStageData).map(([id, yearData]) => {
          const meta = categoryMeta[id] || { name: id, color: '#94a3b8', group: 'Other' };
          
          // 年別・ステージ別集計
          const yearAmounts = {};
          let total = 0;
          let count = 0;
          
          years.forEach(year => {
            let yearTotal = 0;
            let yearCount = 0;
            if (yearData[year]) {
              Object.entries(yearData[year]).forEach(([stage, vals]) => {
                if (selectedStage === 'all' || selectedStage === stage) {
                  yearTotal += vals.amount;
                  yearCount += vals.count;
                }
              });
            }
            yearAmounts[year] = { amount: yearTotal, count: yearCount };
            total += yearTotal;
            count += yearCount;
          });
          
          const y2024 = yearAmounts['2024']?.amount || 0;
          const y2025 = yearAmounts['2025']?.amount || 0;
          const growth = y2024 > 0 ? ((y2025 - y2024) / y2024 * 100) : (y2025 > 0 ? 999 : 0);
          
          return { id, ...meta, total, count, yearAmounts, y2024, y2025, growth };
        });
      }, [selectedStage]);

      // フィルタ&ソート
      const filteredCategories = useMemo(() => {
        let cats = categoryStats.filter(c => c.total > 0);
        if (selectedGroup !== 'all') {
          cats = cats.filter(c => c.group === selectedGroup);
        }
        if (sortBy === 'total') {
          cats.sort((a, b) => b.total - a.total);
        } else if (sortBy === 'count') {
          cats.sort((a, b) => b.count - a.count);
        } else if (sortBy === 'growth') {
          cats.sort((a, b) => b.growth - a.growth);
        } else if (sortBy === '2025') {
          cats.sort((a, b) => (b.yearAmounts['2025']?.amount || 0) - (a.yearAmounts['2025']?.amount || 0));
        }
        return cats;
      }, [categoryStats, selectedGroup, sortBy]);

      // ディールフィルタ
      const filteredDeals = useMemo(() => {
        let deals = allDeals;
        if (selectedCategory) deals = deals.filter(d => d.category === selectedCategory);
        if (selectedYear !== 'all') deals = deals.filter(d => d.year === selectedYear);
        if (selectedStage !== 'all') deals = deals.filter(d => d.stage === selectedStage);
        if (selectedGroup !== 'all') {
          const groupCats = Object.entries(categoryMeta).filter(([k,v]) => v.group === selectedGroup).map(([k]) => k);
          deals = deals.filter(d => groupCats.includes(d.category));
        }
        return deals.sort((a, b) => b.amount - a.amount);
      }, [selectedCategory, selectedYear, selectedStage, selectedGroup]);

      const selectedCatData = selectedCategory ? categoryStats.find(c => c.id === selectedCategory) : null;

      // グループ別年次トレンド
      const yearlyTrendData = useMemo(() => {
        return years.map(year => {
          const row = { year };
          groups.forEach(group => {
            const groupCats = categoryStats.filter(c => c.group === group);
            row[group] = groupCats.reduce((sum, c) => sum + (c.yearAmounts[year]?.amount || 0), 0) / 1000;
          });
          return row;
        });
      }, [categoryStats]);

      // DC詳細トレンド
      const dcTrendData = useMemo(() => {
        const dcCats = ['dc_general', 'ee_computing', 'ee_chips', 'cooling_immersion'];
        return years.map(year => {
          const row = { year };
          dcCats.forEach(catId => {
            const cat = categoryStats.find(c => c.id === catId);
            row[catId] = cat ? (cat.yearAmounts[year]?.amount || 0) : 0;
          });
          return row;
        });
      }, [categoryStats]);

      // 総計算
      const totals = useMemo(() => {
        const total = categoryStats.reduce((sum, c) => sum + c.total, 0);
        const count = categoryStats.reduce((sum, c) => sum + c.count, 0);
        return { total, count };
      }, [categoryStats]);

      return (
        <div style={{ padding: '24px 32px', maxWidth: 1500, margin: '0 auto' }}>
          {/* Header */}
          <div style={{ marginBottom: 20 }}>
            <h1 style={{ fontSize: 22, fontWeight: 700, color: '#0f172a', marginBottom: 4 }}>
              AI Infrastructure Investment Dashboard
            </h1>
            <p style={{ color: '#64748b', fontSize: 13 }}>
              エネルギー・電力セクター (2021-2025) | {totals.count.toLocaleString()}件 | ${(totals.total/1000).toFixed(1)}B | Source: i3 Connect
            </p>
          </div>

          {/* フィルター行 */}
          <div style={{ display: 'flex', gap: 24, marginBottom: 16, flexWrap: 'wrap' }}>
            <div style={{ display: 'flex', gap: 6, alignItems: 'center' }}>
              <span style={{ fontSize: 11, color: '#64748b' }}>グループ:</span>
              <button className={`filter-btn ${selectedGroup === 'all' ? 'active' : ''}`} onClick={() => setSelectedGroup('all')}>All</button>
              {groups.map(g => (
                <button key={g} className={`filter-btn ${selectedGroup === g ? 'active' : ''}`} onClick={() => setSelectedGroup(g)}>{g}</button>
              ))}
            </div>
            <div style={{ display: 'flex', gap: 6, alignItems: 'center' }}>
              <span style={{ fontSize: 11, color: '#64748b' }}>ステージ:</span>
              <button className={`filter-btn ${selectedStage === 'all' ? 'active' : ''}`} onClick={() => setSelectedStage('all')}>All</button>
              {stages.map(s => (
                <button key={s} className={`filter-btn ${selectedStage === s ? 'active' : ''}`} onClick={() => setSelectedStage(s)}>{s}</button>
              ))}
            </div>
          </div>

          {/* KPI Cards */}
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(6, 1fr)', gap: 10, marginBottom: 20 }}>
            <div className="metric-card">
              <div style={{ fontSize: 20, fontWeight: 700, color: '#0f172a' }}>${(totals.total/1000).toFixed(1)}B</div>
              <div style={{ fontSize: 10, color: '#64748b', marginTop: 2 }}>総投資額</div>
            </div>
            <div className="metric-card">
              <div style={{ fontSize: 20, fontWeight: 700, color: '#0f172a' }}>{totals.count.toLocaleString()}</div>
              <div style={{ fontSize: 10, color: '#64748b', marginTop: 2 }}>総ディール数</div>
            </div>
            <div className="metric-card">
              <div style={{ fontSize: 20, fontWeight: 700, color: '#2563eb' }}>${((categoryStats.find(c=>c.id==='dc_general')?.total||0)/1000).toFixed(1)}B</div>
              <div style={{ fontSize: 10, color: '#64748b', marginTop: 2 }}>データセンター</div>
            </div>
            <div className="metric-card">
              <div style={{ fontSize: 20, fontWeight: 700, color: '#16a34a' }}>${((categoryStats.filter(c=>c.group==='Generation').reduce((s,c)=>s+c.total,0))/1000).toFixed(1)}B</div>
              <div style={{ fontSize: 10, color: '#64748b', marginTop: 2 }}>発電（原子力・地熱）</div>
            </div>
            <div className="metric-card">
              <div style={{ fontSize: 20, fontWeight: 700, color: '#0891b2' }}>${((categoryStats.filter(c=>c.group==='Grid').reduce((s,c)=>s+c.total,0))/1000).toFixed(1)}B</div>
              <div style={{ fontSize: 10, color: '#64748b', marginTop: 2 }}>送電網</div>
            </div>
            <div className="metric-card">
              <div style={{ fontSize: 20, fontWeight: 700, color: '#db2777' }}>${((categoryStats.filter(c=>c.group==='Storage').reduce((s,c)=>s+c.total,0))/1000).toFixed(1)}B</div>
              <div style={{ fontSize: 10, color: '#64748b', marginTop: 2 }}>蓄電</div>
            </div>
          </div>

          {/* Main Grid */}
          <div style={{ display: 'grid', gridTemplateColumns: '1.2fr 0.8fr', gap: 16, marginBottom: 20 }}>
            
            {/* Category Table */}
            <div className="card">
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 10 }}>
                <div className="section-title" style={{ marginBottom: 0 }}>セクター別内訳（年別 $M）</div>
                <div style={{ display: 'flex', gap: 4 }}>
                  <button className={`filter-btn ${sortBy === 'total' ? 'active' : ''}`} onClick={() => setSortBy('total')}>累計</button>
                  <button className={`filter-btn ${sortBy === '2025' ? 'active' : ''}`} onClick={() => setSortBy('2025')}>2025</button>
                  <button className={`filter-btn ${sortBy === 'growth' ? 'active' : ''}`} onClick={() => setSortBy('growth')}>成長率</button>
                </div>
              </div>
              
              <div style={{ fontSize: 9, color: '#94a3b8', display: 'grid', gridTemplateColumns: '2fr repeat(5, 1fr) 70px 60px', padding: '4px 10px', borderBottom: '1px solid #e2e8f0', fontWeight: 600 }}>
                <div>セクター</div>
                {years.map(y => <div key={y} className="year-cell">{y}</div>)}
                <div style={{ textAlign: 'right' }}>累計</div>
                <div style={{ textAlign: 'right' }}>YoY</div>
              </div>
              
              <div style={{ maxHeight: 340, overflowY: 'auto' }}>
                {filteredCategories.map(cat => (
                  <div 
                    key={cat.id}
                    className={`category-row ${selectedCategory === cat.id ? 'selected' : ''}`}
                    onClick={() => setSelectedCategory(selectedCategory === cat.id ? null : cat.id)}
                  >
                    <div style={{ display: 'flex', alignItems: 'center', gap: 6 }}>
                      <div style={{ width: 8, height: 8, borderRadius: 2, background: cat.color, flexShrink: 0 }} />
                      <span style={{ fontSize: 10, whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>{cat.name}</span>
                    </div>
                    {years.map(y => (
                      <div key={y} className="year-cell" style={{ 
                        color: (cat.yearAmounts[y]?.amount || 0) > 500 ? '#0f172a' : '#94a3b8',
                        fontWeight: (cat.yearAmounts[y]?.amount || 0) > 1000 ? 600 : 400
                      }}>
                        {cat.yearAmounts[y]?.amount ? Math.round(cat.yearAmounts[y].amount) : '-'}
                      </div>
                    ))}
                    <div style={{ textAlign: 'right', fontWeight: 600, color: '#0f172a' }}>
                      {cat.total >= 1000 ? `${(cat.total/1000).toFixed(1)}B` : `${Math.round(cat.total)}M`}
                    </div>
                    <div style={{ textAlign: 'right', fontSize: 10 }}>
                      {cat.growth === 999 ? (
                        <span style={{ color: '#3b82f6' }}>NEW</span>
                      ) : cat.growth > 0 ? (
                        <span style={{ color: '#16a34a' }}>+{Math.round(cat.growth)}%</span>
                      ) : cat.growth < 0 ? (
                        <span style={{ color: '#dc2626' }}>{Math.round(cat.growth)}%</span>
                      ) : '-'}
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* Charts */}
            <div className="card">
              <div className="section-title">年別投資トレンド（$B）</div>
              <ResponsiveContainer width="100%" height={180}>
                <AreaChart data={yearlyTrendData} margin={{ top: 5, right: 15, left: 0, bottom: 5 }}>
                  <XAxis dataKey="year" stroke="#94a3b8" fontSize={10} />
                  <YAxis stroke="#94a3b8" fontSize={10} tickFormatter={v => `${v.toFixed(0)}`} />
                  <Tooltip contentStyle={{ background: '#fff', border: '1px solid #e2e8f0', borderRadius: 6, fontSize: 10 }} formatter={(v) => `$${v.toFixed(2)}B`} />
                  <Legend wrapperStyle={{ fontSize: 9 }} />
                  <Area type="monotone" dataKey="DC/Computing" stackId="1" stroke="#2563eb" fill="#2563eb" fillOpacity={0.7} />
                  <Area type="monotone" dataKey="Generation" stackId="1" stroke="#16a34a" fill="#16a34a" fillOpacity={0.7} />
                  <Area type="monotone" dataKey="Grid" stackId="1" stroke="#0891b2" fill="#0891b2" fillOpacity={0.7} />
                  <Area type="monotone" dataKey="Storage" stackId="1" stroke="#db2777" fill="#db2777" fillOpacity={0.7} />
                </AreaChart>
              </ResponsiveContainer>

              <div className="section-title" style={{ marginTop: 12 }}>DC/Computing 詳細</div>
              <ResponsiveContainer width="100%" height={140}>
                <LineChart data={dcTrendData} margin={{ top: 5, right: 15, left: 0, bottom: 5 }}>
                  <XAxis dataKey="year" stroke="#94a3b8" fontSize={10} />
                  <YAxis stroke="#94a3b8" fontSize={10} tickFormatter={v => v >= 1000 ? `${(v/1000).toFixed(0)}B` : `${v}M`} />
                  <Tooltip contentStyle={{ background: '#fff', border: '1px solid #e2e8f0', borderRadius: 6, fontSize: 10 }} formatter={(v) => `$${v.toFixed(0)}M`} />
                  <Legend wrapperStyle={{ fontSize: 8 }} />
                  <Line type="monotone" dataKey="dc_general" name="DC汎用" stroke="#2563eb" strokeWidth={2} dot={{ r: 2 }} />
                  <Line type="monotone" dataKey="ee_computing" name="省エネコンピュ" stroke="#7c3aed" strokeWidth={2} dot={{ r: 2 }} />
                  <Line type="monotone" dataKey="cooling_immersion" name="液浸冷却" stroke="#1d4ed8" strokeWidth={2} dot={{ r: 2 }} />
                </LineChart>
              </ResponsiveContainer>
            </div>
          </div>

          {/* Deal List */}
          <div className="card">
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 12 }}>
              <div className="section-title" style={{ marginBottom: 0 }}>
                主要ディール（$50M以上）
                {selectedCatData && (
                  <span style={{ marginLeft: 8, padding: '2px 8px', background: `${selectedCatData.color}20`, color: selectedCatData.color, borderRadius: 4, fontSize: 10 }}>
                    {selectedCatData.name}
                    <span style={{ marginLeft: 4, cursor: 'pointer', opacity: 0.7 }} onClick={(e) => { e.stopPropagation(); setSelectedCategory(null); }}>✕</span>
                  </span>
                )}
              </div>
              <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>
                <select value={selectedYear} onChange={(e) => setSelectedYear(e.target.value)}>
                  <option value="all">全期間</option>
                  {years.map(y => <option key={y} value={y}>{y}</option>)}
                </select>
                <span style={{ fontSize: 10, color: '#94a3b8' }}>{filteredDeals.length}件</span>
              </div>
            </div>

            <div style={{ fontSize: 9, color: '#94a3b8', display: 'grid', gridTemplateColumns: '2fr 1fr 1fr 1fr 1fr', padding: '4px 12px', borderBottom: '1px solid #e2e8f0', fontWeight: 600 }}>
              <div>企業名</div>
              <div>金額</div>
              <div>四半期</div>
              <div>ステージ</div>
              <div>国</div>
            </div>
            
            <div style={{ maxHeight: 280, overflowY: 'auto' }}>
              {filteredDeals.slice(0, 40).map((deal, i) => {
                const cat = categoryMeta[deal.category] || { color: '#94a3b8' };
                return (
                  <div key={i} className="deal-row">
                    <div style={{ display: 'flex', alignItems: 'center', gap: 6 }}>
                      <div style={{ width: 6, height: 6, borderRadius: 2, background: cat.color }} />
                      <span style={{ fontWeight: 500 }}>{deal.company}</span>
                    </div>
                    <div style={{ fontWeight: 600, color: '#0f172a' }}>
                      ${deal.amount >= 1000 ? (deal.amount/1000).toFixed(1) + 'B' : deal.amount.toFixed(0) + 'M'}
                    </div>
                    <div style={{ color: '#64748b' }}>{deal.quarter}</div>
                    <div>
                      <span className="badge" style={{ 
                        background: deal.stage === 'Growth Equity' ? '#dcfce7' : deal.stage === 'Series B' ? '#dbeafe' : deal.stage === 'Series A' ? '#fef3c7' : '#f1f5f9',
                        color: deal.stage === 'Growth Equity' ? '#166534' : deal.stage === 'Series B' ? '#1e40af' : deal.stage === 'Series A' ? '#92400e' : '#475569'
                      }}>{deal.stage}</span>
                    </div>
                    <div style={{ color: '#64748b', fontSize: 11 }}>{deal.country}</div>
                  </div>
                );
              })}
            </div>
          </div>

          {/* Insights */}
          <div className="card" style={{ marginTop: 16 }}>
            <div className="section-title">📊 Key Insights</div>
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: 12 }}>
              <div style={{ padding: 14, background: '#f0f9ff', borderRadius: 8, borderLeft: '3px solid #2563eb' }}>
                <h4 style={{ color: '#2563eb', marginBottom: 6, fontSize: 12 }}>データセンター急成長</h4>
                <div style={{ fontSize: 11, color: '#475569', lineHeight: 1.5 }}>
                  2024-25年にDC投資が急増。Vantage Data Centersの大型案件が牽引。AI需要の影響が顕著。
                </div>
              </div>
              <div style={{ padding: 14, background: '#f0fdf4', borderRadius: 8, borderLeft: '3px solid #16a34a' }}>
                <h4 style={{ color: '#16a34a', marginBottom: 6, fontSize: 12 }}>ベースロード電源の台頭</h4>
                <div style={{ fontSize: 11, color: '#475569', lineHeight: 1.5 }}>
                  原子力マイクロ炉（X-Energy）・地熱（Fervo）が成長。24時間稼働のクリーン電源需要を反映。
                </div>
              </div>
              <div style={{ padding: 14, background: '#faf5ff', borderRadius: 8, borderLeft: '3px solid #7c3aed' }}>
                <h4 style={{ color: '#7c3aed', marginBottom: 6, fontSize: 12 }}>リチウム電池の転換期</h4>
                <div style={{ fontSize: 11, color: '#475569', lineHeight: 1.5 }}>
                  リチウム電池は2021年をピークに減少。フロー電池・ナトリウム・機械式への分散が進行。
                </div>
              </div>
            </div>
          </div>

          <div style={{ textAlign: 'center', marginTop: 24, color: '#94a3b8', fontSize: 10 }}>
            Data Source: i3 Connect | Period: 2021-2025 | Updated: 2025
          </div>
        </div>
      );
    }

    // React 18のcreateRootを使用
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<Dashboard />);
  </script>
</body>
</html>
